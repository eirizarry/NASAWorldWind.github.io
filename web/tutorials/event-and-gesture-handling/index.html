<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <meta name="description" content="NASA WorldWind Software Development Kits (SDKs) for geo-spatial 3D virtual
        globe visualization via OpenGL/WebGL on Android, Java and JavaScript/HTML5 platforms.">
        <link rel="icon" href="/img/favicon.ico" type="image/x-icon"/>
        <link rel="stylesheet" type="text/css" href="/css/bootstrap.min.css">
        <link rel="stylesheet" type="text/css" href="/css/theme.css">
        <title>
            Event and Gesture Handling
        </title>
    </head>
    <body>
             
        <nav class="navbar navbar-default">
            <div class="container">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a href="/"><img id="logo-size" src="/img/nasa-logo.svg" alt="Meatball"/></a>
                    <a class="navbar-brand" href="/">NASA WorldWind</a>
                </div>
                <div id="navbar" class="navbar-collapse collapse">
                    <ul class="nav navbar-nav navbar-right">
                        <li><a href="/about">About</a></li>
                        <li><a href="/web">Web</a></li>
                        <li><a href="/android">Android</a></li>
                        <li><a href="/java">Java</a></li>
                        <li><a href="/contact">Contact</a></li>
                    </ul>
                </div>
            </div>
        </nav>

        
    <div class="container">
    <h2>Web WorldWind</h2>
</div>
<hr>
<div class="container">
    <div class="row row-centered">
        <div class="col-xs-6 col-centered col-max">
            <a href="/web/">Home</a>
        </div>            
        <div class="col-xs-6 col-centered col-max">
            <a href="/web/get-started/">Get Started</a>
        </div>
        <div class="col-xs-6 col-centered col-max">
            <a href="/web/features/">Features</a>
        </div>
        <div class="col-xs-6 col-centered col-max">
            <a href="/web/examples/">Examples</a>
        </div>
        <div class="col-xs-6 col-centered col-max">
            <a href="/web/tutorials/">Tutorials</a>
        </div>
        <div class="col-xs-6 col-centered col-max">
            <a href="/web/docs/">Docs</a>
        </div>
    </div>
</div>
<hr>
    <div class="container">
        

<h2 id="event-and-gesture-handling">Event and Gesture Handling</h2>

<p>Applications can generally monitor and respond to JavaScript events as they normally would. But because the WorldWindow’s navigator is monitoring mouse and touch events to enable the user to manipulate the globe, some coordination between the application’s event handling and the navigator’s event handling is necessary. Web WorldWind does not monitor keyboard events, so no coordination is necessary for those.</p>

<p>If your application is to work on conventional and mobile devices, it should monitor both mouse events and gestures if it wants to respond to user input beyond what the WorldWindow’s navigator already does. Web WorldWind examples such as PlacemarksAndPicking.js and GoToLocation.js do this.</p>

<h2 id="monitoring-mouse-events">Monitoring Mouse Events</h2>

<p>Applications wishing to monitor mouse events (other than click events, as described below) should register their event handlers using the addEventListener function on WorldWindow:</p>

<pre><code class="language-javascript">var wwd = new WorldWind.WorldWindow(&quot;canvasOne&quot;);
wwd.addEventListener(&quot;mousemove&quot;, function (event) {...});
</code></pre>

<p>Event listeners added this way are invoked prior to the navigator’s event handlers. Application event handlers responding to the event should call preventDefault on the listener’s event argument so that the navigator and any subsequent event handlers know to ignore it:</p>

<pre><code class="language-javascript">wwd.addEventListener(&quot;mousemove&quot;, function (event) {
    
    ... // potentially respond to the event
    
    if (eventHandled) {
        event.preventDefault();
    }
});
</code></pre>

<p>Event handlers should also of course first check the event to see if it’s already been handled:</p>

<pre><code class="language-javascript">if (event.defaultPrevented) {
    return; // return without doing anything
}
</code></pre>

<h2 id="click-events">Click Events</h2>

<p>Click events are the exception to specifying event listeners, and should instead be handled using a ClickRecognizer rather than an event listener:</p>

<pre><code class="language-javascript">// Listen for mouse clicks.
var clickRecognizer = new WorldWind.ClickRecognizer(wwd, 
    function(recognizer) {
        ...
});
</code></pre>

<p>The click recognizer works in conjunction with the navigator’s event handlers and gesture recognizers to avoid duplicate handling. See the API doc for ClickRecognizer for the details of this class.</p>

<p>The example PickAllShapesInRegion.js illustrates event handling and how to register event handlers. The example GoToLocation.js shows how to use a click recognizer. See also the example fragment in the next section.</p>

<h2 id="monitoring-touch-events-and-gestures">Monitoring Touch Events and Gestures</h2>

<p>Rather than monitoring touch events directly, applications should use Web WorldWind’s gesture recognizers. Of most use is the TapRecognizer, which recognizes tap gestures on touch screens. Below is how the GoToLocation.js example uses a tap recognizer to recognize a tap and determine a location to move to when the user taps on the globe. The tap gesture recognizer is created and the gesture handler specified in the emboldened lines:</p>

<pre><code class="language-javascript">// The common gesture-handling function.
var handleClick = function (recognizer) {
    // Obtain the event location.
    var x = recognizer.clientX,
        y = recognizer.clientY;

    // Perform the pick. Must first convert from window coordinates to canvas coordinates, which are
    // relative to the upper left corner of the canvas rather than the upper left corner of the page.
    var pickList = wwd.pick(wwd.canvasCoordinates(x, y));

    // If only one thing is picked and it is the terrain, use a go-to animator to go to the picked location.
    if (pickList.objects.length == 1 &amp;&amp; pickList.objects[0].isTerrain) {
        var position = pickList.objects[0].position;
        goToAnimator.goTo(new WorldWind.Location(position.latitude, position.longitude));
    }
};

// Listen for mouse clicks.
var clickRecognizer = new WorldWind.ClickRecognizer(wwd, handleClick);

// Listen for taps on mobile devices.
var tapRecognizer = new WorldWind.TapRecognizer(wwd, handleClick);
</code></pre>

    </div>

       
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    </body>
</html>